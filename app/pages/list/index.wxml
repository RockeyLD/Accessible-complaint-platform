<view class="page list-page">
  <view class="header">
    <text class="title">历史记录</text>
    <text class="subtitle">查看已提交的吐槽内容。</text>
  </view>

  <view class="toolbar">
    <input
      placeholder="搜索关键词..."
      value="{{keyword}}"
      bindinput="onSearchInput"
    />
    <button class="ghost" bindtap="onRefresh">刷新</button>
    <button class="ghost danger" bindtap="onClearAll">清空所有</button>
  </view>

  <text class="status">{{statusText}}</text>

  <view wx:if="{{filteredItems.length === 0}}" class="empty">
    还没有保存的吐槽记录。
  </view>

  <view wx:for="{{filteredItems}}" wx:key="id" class="complaint-card">
    <view class="card-header">
      <text class="card-title">{{item.title}}</text>
      <text class="card-meta">{{item.displayTime}} · {{item.modeLabel}}</text>
    </view>
    <view class="card-body">
      <text wx:if="{{item.sentence}}">摘要：{{item.sentence}}</text>
      <text wx:if="{{item.problem}}">问题：{{item.problem}}</text>
      <text wx:if="{{item.impact}}">影响：{{item.impact}}</text>
      <text wx:if="{{item.wish}}">期望：{{item.wish}}</text>
      <text wx:if="{{item.summary}}">一句话：{{item.summary}}</text>
      <text wx:if="{{item.detail}}">详细：{{item.detail}}</text>
      <text wx:if="{{item.scene}}">场景：{{item.scene}}</text>
      <text wx:if="{{item.severity}}">影响程度：{{item.severity}}</text>
      <text wx:if="{{item.contact}}">联系方式：{{item.contact}}</text>
    </view>
    <view class="card-tags">
      <text wx:if="{{item.categoriesText}}">类别：{{item.categoriesText}}</text>
      <text wx:if="{{item.emotion}}">情绪：{{item.emotion}}</text>
      <text wx:if="{{item.visibility}}">公开方式：{{item.visibility}}</text>
    </view>
    <view class="card-actions">
      <button class="ghost danger" data-id="{{item.id}}" bindtap="onDeleteItem">删除</button>
    </view>
  </view>
</view>
